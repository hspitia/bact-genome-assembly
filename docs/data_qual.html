<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.253">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Ensamblaje y Anotación de Genomas Bacterianos - 3&nbsp; Control de calidad y limpieza de datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assembly.html" rel="next">
<link href="./data.html" rel="prev">
<link href="./assets/images/book.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data_qual.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Control de calidad y limpieza de datos</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Ensamblaje y Anotación de Genomas Bacterianos</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenid@</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preparación del entorno de trabajo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Obtención de datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_qual.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Control de calidad y limpieza de datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assembly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ensamblaje</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Apéndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-fastqc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">FastQC help</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#software-requerido" id="toc-software-requerido" class="nav-link active" data-scroll-target="#software-requerido"><span class="header-section-number">3.1</span> Software requerido</a></li>
  <li><a href="#determinación-de-calidad" id="toc-determinación-de-calidad" class="nav-link" data-scroll-target="#determinación-de-calidad"><span class="header-section-number">3.2</span> Determinación de calidad</a>
  <ul class="collapse">
  <li><a href="#reporte-de-calidad-fastqc" id="toc-reporte-de-calidad-fastqc" class="nav-link" data-scroll-target="#reporte-de-calidad-fastqc"><span class="header-section-number">3.2.1</span> Reporte de calidad FastQC</a></li>
  <li><a href="#unificando-los-reportes-de-calidad" id="toc-unificando-los-reportes-de-calidad" class="nav-link" data-scroll-target="#unificando-los-reportes-de-calidad"><span class="header-section-number">3.2.2</span> Unificando los reportes de calidad</a></li>
  </ul></li>
  <li><a href="#limpieza" id="toc-limpieza" class="nav-link" data-scroll-target="#limpieza"><span class="header-section-number">3.3</span> Limpieza</a></li>
  <li><a href="#verificación-de-calidad-después-de-la-limpieza" id="toc-verificación-de-calidad-después-de-la-limpieza" class="nav-link" data-scroll-target="#verificación-de-calidad-después-de-la-limpieza"><span class="header-section-number">3.4</span> Verificación de calidad después de la limpieza</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Control de calidad y limpieza de datos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Una vez descargados los datos, el siguiente paso consiste en hacer control de calidad y limpieza de los datos. En este paso primero se revisa la calidad de los datos, y luego se editan o eliminan las lecturas (<em>reads</em>) que no tienen la calidad necesaria para conseguir un buen ensamblaje.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Es importante comprender la calidad de los datos de secuenciación. Puede aprender sobre el puntaje Phred y cómo se codifica en el formato FASTQ en los artículos de Wikipedia <a href="https://es.wikipedia.org/wiki/Nivel_de_calidad_Phred"><em>“Nivel de calidad Phred”</em></a> y <a href="https://en.wikipedia.org/wiki/FASTQ_format"><em>“FASTQ format”</em></a>, respectivamente.</p>
</div>
</div>
<section id="software-requerido" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="software-requerido"><span class="header-section-number">3.1</span> Software requerido</h2>
<table class="table">
<thead>
<tr class="header">
<th>Software</th>
<th>Versión</th>
<th>Descripción</th>
<th>Ref.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FastQC</td>
<td>0.12.1</td>
<td>Herramienta para el control de calidad en datos de secuenciación de alto rendimiento</td>
<td><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">Sitio Web</a></td>
</tr>
<tr class="even">
<td>MultiQC</td>
<td>1.14</td>
<td>Herramienta para unificar y resumir múltiples reportes generados por FastQC y muchos otros programas de bioinformática.</td>
<td><span class="citation" data-cites="ewels2016">Ewels et&nbsp;al. (<a href="references.html#ref-ewels2016" role="doc-biblioref">2016</a>)</span>; <a href="https://multiqc.info/">sitio Web</a></td>
</tr>
<tr class="odd">
<td>fastp</td>
<td>0.23.2</td>
<td>Herramienta para el pre-procesamiento rápido de archivos Fastq.</td>
<td><span class="citation" data-cites="chen2018">Chen et&nbsp;al. (<a href="references.html#ref-chen2018" role="doc-biblioref">2018</a>)</span>; <a href="https://github.com/OpenGene/fastp">repositorio GitHub</a></td>
</tr>
</tbody>
</table>
</section>
<section id="determinación-de-calidad" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="determinación-de-calidad"><span class="header-section-number">3.2</span> Determinación de calidad</h2>
<p>Para revisar la calidad de los datos descargados, usaremos <code>fastqc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrar al directorio del proyecto y al directorio datos</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ensamblaje/datos</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Analizar todos los archivos descargados</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="at">-o</span> qc/fastqc <span class="pp">*</span>.fastq.gz</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación verá mensajes de progreso de <code>fastqc</code>:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Started analysis of SRR18335437_1.fastq.gz
Approx 5% complete for SRR18335437_1.fastq.gz
Approx 10% complete for SRR18335437_1.fastq.gz
Approx 15% complete for SRR18335437_1.fastq.gz
Approx 20% complete for SRR18335437_1.fastq.gz
Approx 25% complete for SRR18335437_1.fastq.gz
Approx 30% complete for SRR18335437_1.fastq.gz
Approx 35% complete for SRR18335437_1.fastq.gz
Approx 40% complete for SRR18335437_1.fastq.gz
Approx 45% complete for SRR18335437_1.fastq.gz
Approx 50% complete for SRR18335437_1.fastq.gz
Approx 55% complete for SRR18335437_1.fastq.gz
Approx 60% complete for SRR18335437_1.fastq.gz
Approx 65% complete for SRR18335437_1.fastq.gz
Approx 70% complete for SRR18335437_1.fastq.gz
Approx 75% complete for SRR18335437_1.fastq.gz
Approx 80% complete for SRR18335437_1.fastq.gz
Approx 85% complete for SRR18335437_1.fastq.gz
Approx 90% complete for SRR18335437_1.fastq.gz
Approx 95% complete for SRR18335437_1.fastq.gz
Analysis complete for SRR18335437_1.fastq.gz
...</code></pre>
</div>
</div>
<p>Al final, por cada archivo <code>.fastq</code> analizado, <code>fastqc</code> genera un archivo <code>.html</code> con el reporte de calidad y un archivo comprimido (<code>.zip</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> qc/fastqc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>SRR18335437_1_fastqc.html  SRR18335438_2_fastqc.html  SRR22388519_1_fastqc.html
SRR18335437_1_fastqc.zip   SRR18335438_2_fastqc.zip   SRR22388519_1_fastqc.zip
SRR18335437_2_fastqc.html  SRR22388518_1_fastqc.html  SRR22388519_2_fastqc.html
SRR18335437_2_fastqc.zip   SRR22388518_1_fastqc.zip   SRR22388519_2_fastqc.zip
SRR18335438_1_fastqc.html  SRR22388518_2_fastqc.html
SRR18335438_1_fastqc.zip   SRR22388518_2_fastqc.zip</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>El archivo comprimido <code>.zip</code> contiene una copia del reporte <code>.html</code>, gráficos, y archivos de estadísticas.</p>
</div>
</div>
<section id="reporte-de-calidad-fastqc" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="reporte-de-calidad-fastqc"><span class="header-section-number">3.2.1</span> Reporte de calidad FastQC</h3>
<p>Analicemos uno de los reportes de calidad de FastQC. Abra el archivo <code>SRR18335437_1_fastqc.html</code>. El reporte contiene diferentes secciones, llamadas módulos, que corresponden a diferentes evaluaciones de calidad que la herramienta hace sobre los datos (<a href="#fig-fastqc-report">Figura&nbsp;<span>3.1</span></a>). Puede consultar información detallada (en inglés) a cerca de FastQC y sus módulos en el <a href="a-fastqc.html"><span>Apéndice&nbsp;A</span></a>. Por cada módulo, el reporte presenta un ícono con tres posibles estados de acuerdo al resultado de la evaluación (<a href="#tbl-fastqc-results">Tabla&nbsp;<span>3.1</span></a>).</p>
<div id="tbl-fastqc-results" class="anchored">
<table class="table">
<caption>Tabla&nbsp;3.1. Posibles resultados de la evaluación de calidad realizada por la herramienta FastQC</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Símbolo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="assets/images/fastqc-tick.png" class="img-fluid" style="width:0.26in"></td>
<td>Pasó. La muestra pasó la evaluación de calidad en esta categoría (módulo). No hay problemas de calidad.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="assets/images/fastqc-warning.png" class="img-fluid" style="width:0.26in"></td>
<td>Advertencia. La muestra tiene un posible problema calidad. El usuario debería revisar la muestra y tomar las medidas necesarias para evitar el error de ser posible. Por la naturaleza de la secuenciación de ADN, es normal que se presenten advertencias en algunos módulos en las muestras sin que signifique que haya un problema real o grave.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="assets/images/fastqc-error.png" class="img-fluid" style="width:0.26in"></td>
<td>Falló. La muestra falló la evaluación de calidad en este módulo. El usuario debería limpiar los datos para corregir el error.</td>
</tr>
</tbody>
</table>
</div>
<p>De acuerdo con los estados, vemos que las muestras fallaron las evaluaciones de calidad de los módulos <em>“Per base sequence quality”</em> y <em>“Sequence Duplication Levels”</em>, y el módulo <em>“Sequence Length Distribution”</em> tiene una advertencia (<a href="#fig-fastqc-report">Figura&nbsp;<span>3.1</span></a>).</p>
<div id="fig-fastqc-report" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/fastqc-report.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3.1. Captura de pantalla de un reporte de calidad generado con la aplicación FastQC.</figcaption><p></p>
</figure>
</div>
<p>Tal vez el módulo más importante a revisar es <em>“Per base sequence quality”</em> (<a href="a-fastqc.html#sec-perbase-seq-qual"><span>Sección&nbsp;A.3.5</span></a>), el cual muestra el valor de calidad de por cada posición a lo largo de las secuencias del archivo procesado. Típicamente en archivos producidos con tecnología Illumina, la calidad es baja en las primeras siete a 10 bases de las secuencias, incrementando hasta alcanzar su máximo hacia la parte media de la secuencia. Luego la calidad empieza a decrecer hasta encontrar sus mínimos valores al final de la secuencia. Comúnmente la calidad mínima para lograr ensamblajes decentes es <span class="math inline">\(Q \ge 20\)</span> (eje Y en el gráfico). Así, este gráfico el crucial para que el usuario decida el número de bases (eje X) que se recortarán en los extremos de las secuencias (inicio 5’; final 3’), los cuales típicamente contienen las secciones con menor calidad.</p>
</section>
<section id="unificando-los-reportes-de-calidad" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="unificando-los-reportes-de-calidad"><span class="header-section-number">3.2.2</span> Unificando los reportes de calidad</h3>
<p>Dado que los reportes de FastQC son independientes por cada archivo de lecturas (<code>_1</code> y <code>_2</code>) y cada muestra, es difícil tener una visión general de la calidad de todos los datos en conjunto. Conviene entonces unificar los datos de calidad en un solo reporte para lograr una mejor interpretación de la información.</p>
<p>Esta unificación se logra con la aplicación MultiQC. Ejecute la siguiente orden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">multiqc</span> <span class="at">--filename</span> multiqc_report.html <span class="at">--outdir</span> qc qc/fastqc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  /// MultiQC 🔍 | v1.14

|           multiqc | Search path : /home/hector/ensamblaje/datos/qc/fastqc
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 16/16  
|            fastqc | Found 8 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : qc/multiqc_report.html
|           multiqc | Data        : qc/multiqc_report_data
|           multiqc | MultiQC complete</code></pre>
</div>
</div>
<p>Ahora MultiQC ha generado dos elementos, el archivo <code>multiqc_report.html</code> y un directorio <code>multiqc_report_data</code> que contiene archivos de estadísticas. Al abrir el reporte <code>.html</code> se puede ver la información de calidad de todos los archivos analizados con FastqQC (<a href="#fig-multiqc">Figura&nbsp;<span>3.2</span></a>).</p>
<div id="fig-multiqc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/multiqc-report.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3.2. Captura de pantalla del reporte de calidad unificado generado con MultiQC.</figcaption><p></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Abra el reporte <a href="ensamblaje/datos/qc/multiqc_report.html"><code>ensamblaje/datos/qc/multiqc_report.html</code></a> para revisar toda la información de calidad evaluada por FastQC.</p>
</div>
</div>
<p>Revisando la sección <em>“General Statistics”</em> del reporte MultiQC, podemos observar que los tamaños de secuencia varían según la muestra. La longitud (mediana) de secuencias de las muestras <code>SRR18335437</code> y <code>SRR18335438</code> es de 150 bp, mientras que la de las muestras <code>SRR22388518</code> y <code>SRR22388518</code> es de 251 bp.</p>
<p>Echemos un vistazo ahora al gráfico de calidad de secuenciación en la sección <em>“Sequence Quality Histograms”</em> (<a href="#fig-per-base-qual">Figura&nbsp;<span>3.3</span></a>). Además de la diferencia de longitud de secuencias, se puede notar que:</p>
<ul>
<li><p>La calidad al inicio de las secuencias en todos los archivos es buena (<span class="math inline">\(Q \ge 30\)</span>)</p></li>
<li><p>La calidad al final de las secuencias es aceptable (<span class="math inline">\(Q \ge 20\)</span>) en todos los archivos, con excepción de las secuencias <em>reverse</em> (<code>_2</code>) de las muestras <code>SRR22388518</code> y <code>SRR22388519</code>.</p></li>
</ul>
<p>De estas observaciones se puede concluir que la limpieza de los datos consistirá en recortar las últimas bases (aprox. 20) de los archivos <code>SRR22388518_2.fastq.gz</code> y <code>SRR22388519_2.fastq.gz</code> pues son las que presentan baja calidad. Además, como buena práctica, se eliminarán aquellas secuencias cuya calidad promedio sea <span class="math inline">\(Q &lt; 20\)</span>.</p>
<div id="fig-per-base-qual" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/mqc_fastqc_per_base_sequence_quality_plot_1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3.3. Gráfico de calidad de secuenciación por base</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="limpieza" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="limpieza"><span class="header-section-number">3.3</span> Limpieza</h2>
<p>Usaremos la aplicación fastp para recortar y filtrar las secuencias por calidad. Empecemos procesando la primera muestra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrar al directorio raíz del proyecto (en mi caso, /home/hector/ensamblaje)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ..</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Comando para ejecutar la limpieza de la primera muestra</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--verbose</span> <span class="dt">\</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">--thread</span> 4 <span class="dt">\</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">--detect_adapter_for_pe</span> <span class="dt">\</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_tail</span> <span class="dt">\</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_mean_quality</span> 20 <span class="dt">\</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">--average_qual</span> 20 <span class="dt">\</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">--report_title</span> <span class="st">'Reporte fastp: SRR22388518'</span> <span class="dt">\</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in1</span> datos/SRR22388518_1.fastq.gz <span class="dt">\</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in2</span> datos/SRR22388518_2.fastq.gz <span class="dt">\</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out1</span> resultados/00_datos_limpios/SRR22388518_1.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out2</span> resultados/00_datos_limpios/SRR22388518_2.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired1</span> resultados/00_datos_limpios/SRR22388518_1.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired2</span> resultados/00_datos_limpios/SRR22388518_2.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">--html</span> resultados/00_datos_limpios/qc/fastp/SRR22388518.report.fastp.html <span class="dt">\</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">--json</span> resultados/00_datos_limpios/qc/fastp/SRR22388518.report.fastp.json</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Antes de revisar el resultado, veamos las opciones usadas con el comando y su finalidad:</p>
<ul>
<li><code>--verbose</code>: provee información adicional durante el procesamiento de los archivos</li>
<li><code>--thread 4</code>: usa cuatro hilos de ejecución de manera paralela para acelerar el procesamiento de los archivos</li>
<li><code>--detect_adapter_for_pe</code>: detecta las secuencias de adaptadores de secuenciación y las elimina</li>
<li><code>--cut_tail</code>: corta la “cola” (<em>tail</em>) de las secuencias, la cual se dijo tiene las bases de más baja calidad</li>
<li><code>--cut_mean_quality 20</code>: la calidad media mínima aceptada para corte de secuencias. fastp usa una ventana de 4 bases desde el extremo de la secuencia para revisar calidad; si el promedio de estas cuatro bases está por debajo de 20, elimina este extremo.</li>
<li><code>--average_qual 20</code>: la calidad media mínima aceptada para mantener una secuencia. Si al calcular la calidad media de toda la secuencia está por debajo de 20, la secuencia es descartada.</li>
<li><code>--report_title 'Reporte fastp: SRR22388518'</code>: el título del reporte</li>
<li><code>--in1</code>: el archivo de secuencias <em>forward</em> a ser procesado</li>
<li><code>--in2</code>: el archivo de secuencias <em>reverse</em> a ser procesado</li>
<li><code>--out1</code>: el archivo de salida con las secuencias <em>forward</em> que pasaron el control de calidad</li>
<li><code>--out2</code>: el archivo de salida con las secuencias <em>reverse</em> que pasaron el control de calidad</li>
<li><code>--unpaired1</code>: el archivo de salida con las secuencias <em>forward</em> no pareadas que pasaron el control de calidad (no tienen una secuencia par <em>reverse</em>)</li>
<li><code>--unpaired2</code>: el archivo de salida con las secuencias <em>reverse</em> no pareadas que pasaron el control de calidad (no tienen una secuencia par <em>forward</em>)</li>
<li><code>--html</code>: el archivo de reporte en formato html</li>
<li><code>--json</code>: el archivo de reporte en formato json (estadísticas)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para conocer todas las opciones disponibles de fastp consulte la ayuda ejecutando <code>fastp --help</code>.</p>
</div>
</div>
<p>En el anterior comando, en lugar de cortar un número determinado de bases al final de las secuencias, se usa la estrategia del programa fastp. Por cada secuencia del archivo, fastp revisa la calidad media de una pequeña porción de 4 bases, llamado ventana, empezando desde el extremo final. Si la calidad media está por debajo del mínimo definido (20 en este caso), fastp recorta esta ventana de la secuencia. Este proceso se repita hasta que no se encuentre una ventana que deba recortarse. Así, solo las secuencias con baja calidad al final son recortadas. Este mismo principio se puede aplicar para el inicio de las secuencias, cuando sea el caso.</p>
<p>Veamos ahora el resultado de fastp. Al ejecutar el anterior comando veremos una salida parecida a esto:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Detecting adapter sequence for read1...
&gt;Illumina TruSeq Adapter Read 1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCA

Detecting adapter sequence for read2...
No adapter detected for read2

[19:24:32] start to load data of read1 
[19:24:32] start to load data of read2 
[19:24:36] Read1: loading completed with 871 packs 
[19:24:36] Read2: loading completed with 871 packs 
[19:24:39] thread 4 data processing completed 
[19:24:39] thread 4 finished 
[19:24:39] thread 3 data processing completed 
[19:24:39] thread 3 finished 
[19:24:39] thread 2 data processing completed 
[19:24:39] thread 2 finished 
[19:24:39] thread 1 data processing completed 
[19:24:39] thread 1 finished 
[19:24:39] resultados/00_datos_limpios/SRR22388518_1.unpaired.fastq.gz writer finished 
[19:24:39] resultados/00_datos_limpios/SRR22388518_2.unpaired.fastq.gz writer finished 
[19:24:40] resultados/00_datos_limpios/SRR22388518_2.clean.fastq.gz writer finished 
[19:24:40] resultados/00_datos_limpios/SRR22388518_1.clean.fastq.gz writer finished 
[19:24:40] start to generate reports
 
Read1 before filtering:
total reads: 870940
total bases: 218350507
Q20 bases: 198719240(91.0093%)
Q30 bases: 184185641(84.3532%)

Read2 before filtering:
total reads: 870940
total bases: 218399177
Q20 bases: 175386628(80.3055%)
Q30 bases: 149084629(68.2624%)

Read1 after filtering:
total reads: 863093
total bases: 209876970
Q20 bases: 193175278(92.0422%)
Q30 bases: 180122777(85.823%)

Read2 after filtering:
total reads: 863093
total bases: 201834951
Q20 bases: 170111238(84.2823%)
Q30 bases: 146895463(72.78%)

Filtering result:
reads passed filter: 1726186
reads failed due to low quality: 12556
reads failed due to too many N: 488
reads failed due to too short: 2650
reads with adapter trimmed: 150684
bases trimmed due to adapters: 7399476

Duplication rate: 0.0137782%

Insert size peak (evaluated by paired-end reads): 251

JSON report: resultados/00_datos_limpios/qc/fastp/report.fastp.json
HTML report: resultados/00_datos_limpios/qc/fastp/report.fastp.html

fastp --verbose --thread 4 --detect_adapter_for_pe --cut_tail --cut_mean_quality 20 --average_qual 20 --report_title Reporte fastp: SRR22388518 --in1 datos/SRR22388518_1.fastq.gz --in2 datos/SRR22388518_2.fastq.gz --out1 resultados/00_datos_limpios/SRR22388518_1.clean.fastq.gz --out2 resultados/00_datos_limpios/SRR22388518_2.clean.fastq.gz --unpaired1 resultados/00_datos_limpios/SRR22388518_1.unpaired.fastq.gz --unpaired2 resultados/00_datos_limpios/SRR22388518_2.unpaired.fastq.gz --html resultados/00_datos_limpios/qc/fastp/SRR22388518.report.fastp.html --json resultados/00_datos_limpios/qc/fastp/SRR22388518.report.fastp.json 
fastp v0.23.2, time used: 22 seconds</code></pre>
</div>
</div>
<p>Podemos encontrar información importante en los mensajes de la salida, como por ejemplo el número de secuencias y calidad antes y después de aplicar la limpieza o filtrado (secciones <code>Read1 before filtering:</code>, <code>Read2 before filtering:</code>, <code>Read1 after filtering:</code> y <code>Read2 after filtering:</code>), y el resumen del número de reads que pasaron y no pasaron el filtro (sección <code>Filtering result</code>).</p>
<p>Junto con los archivos de secuencias filtradas, fastp genera un archivo de reporte <code>.html</code> y un archivo de estadísticas.</p>
<p>Ahora se deben procesar el resto de los archivos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--verbose</span> <span class="dt">\</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">--thread</span> 4 <span class="dt">\</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">--detect_adapter_for_pe</span> <span class="dt">\</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_tail</span> <span class="dt">\</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_mean_quality</span> 20 <span class="dt">\</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">--average_qual</span> 20 <span class="dt">\</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">--report_title</span> <span class="st">'Reporte fastp: SRR22388519'</span> <span class="dt">\</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in1</span> datos/SRR22388519_1.fastq.gz <span class="dt">\</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in2</span> datos/SRR22388519_2.fastq.gz <span class="dt">\</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out1</span> resultados/00_datos_limpios/SRR22388519_1.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out2</span> resultados/00_datos_limpios/SRR22388519_2.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired1</span> resultados/00_datos_limpios/SRR22388519_1.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired2</span> resultados/00_datos_limpios/SRR22388519_2.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">--html</span> resultados/00_datos_limpios/qc/fastp/SRR22388519.report.fastp.html <span class="dt">\</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">--json</span> resultados/00_datos_limpios/qc/fastp/SRR22388519.report.fastp.json</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--verbose</span> <span class="dt">\</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">--thread</span> 4 <span class="dt">\</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">--detect_adapter_for_pe</span> <span class="dt">\</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_tail</span> <span class="dt">\</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_mean_quality</span> 20 <span class="dt">\</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">--average_qual</span> 20 <span class="dt">\</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">--report_title</span> <span class="st">'Reporte fastp: SRR18335437'</span> <span class="dt">\</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in1</span> datos/SRR18335437_1.fastq.gz <span class="dt">\</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in2</span> datos/SRR18335437_2.fastq.gz <span class="dt">\</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out1</span> resultados/00_datos_limpios/SRR18335437_1.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out2</span> resultados/00_datos_limpios/SRR18335437_2.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired1</span> resultados/00_datos_limpios/SRR18335437_1.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired2</span> resultados/00_datos_limpios/SRR18335437_2.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">--html</span> resultados/00_datos_limpios/qc/fastp/SRR18335437.report.fastp.html <span class="dt">\</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">--json</span> resultados/00_datos_limpios/qc/fastp/SRR18335437.report.fastp.json</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--verbose</span> <span class="dt">\</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">--thread</span> 4 <span class="dt">\</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">--detect_adapter_for_pe</span> <span class="dt">\</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_tail</span> <span class="dt">\</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">--cut_mean_quality</span> 20 <span class="dt">\</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">--average_qual</span> 20 <span class="dt">\</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">--report_title</span> <span class="st">'Reporte fastp: SRR18335438'</span> <span class="dt">\</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in1</span> datos/SRR18335438_1.fastq.gz <span class="dt">\</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">--in2</span> datos/SRR18335438_2.fastq.gz <span class="dt">\</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out1</span> resultados/00_datos_limpios/SRR18335438_1.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">--out2</span> resultados/00_datos_limpios/SRR18335438_2.clean.fastq.gz <span class="dt">\</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired1</span> resultados/00_datos_limpios/SRR18335438_1.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">--unpaired2</span> resultados/00_datos_limpios/SRR18335438_2.unpaired.fastq.gz <span class="dt">\</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">--html</span> resultados/00_datos_limpios/qc/fastp/SRR18335438.report.fastp.html <span class="dt">\</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">--json</span> resultados/00_datos_limpios/qc/fastp/SRR18335438.report.fastp.json</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verificación-de-calidad-después-de-la-limpieza" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="verificación-de-calidad-después-de-la-limpieza"><span class="header-section-number">3.4</span> Verificación de calidad después de la limpieza</h2>
<p>Finalmente podemos usar FastQC y MultiQC para revisar la calidad de las muestras después de la limpieza:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar reportes con FastQC</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="at">-o</span> resultados/00_datos_limpios/qc/fastqc resultados/00_datos_limpios/<span class="pp">*</span>.clean.fastq.gz</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar reporte unificado con MultiQC</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="ex">multiqc</span> <span class="dt">\</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">--filename</span> multiqc_report.html <span class="dt">\</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">--outdir</span> resultados/00_datos_limpios/qc <span class="dt">\</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  resultados/00_datos_limpios/qc/fastp <span class="dt">\</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  resultados/00_datos_limpios/qc/fastqc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note que en el anterior comando de MultiQC se pasó no solo el directorio de reportes FastQC, sino también el directorio con los reportes de fastp. La aplicación se encarga de generar un solo documento <code>.html</code> con dos secciones, una para fastp y otra para FastQC.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Explore el reporte <a href="ensamblaje/resultados/00_datos_limpios/qc/multiqc_report.html"><code>resultados/00_datos_limpios/qc/multiqc_report.html</code></a> para ver las diferentes estadísticas de calidad después de haber aplicado los filtros a las muestras.</p>
</div>
</div>
<p>Echemos un vistazo al gráfico de calidad de secuenciación por base generado sobre los datos limpios (<a href="#fig-per-base-qual">Figura&nbsp;<span>3.3</span></a>). Podemos ver que las dos muestras que te tenían baja calidad hacia el final de las secuencias, ahora aparecen en color naranja, con una calidad <span class="math inline">\(Q &gt; 20\)</span>.</p>
<p><img src="assets/images/mqc_fastqc_per_base_sequence_quality_plot_1_after_filter.png" id="fig-per-base-qual-after" class="img-fluid"></p>
<p>Finalmente las muestras están listas para ser ensambladas.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-chen2018" class="csl-entry" role="listitem">
Chen, Shifu, Yanqing Zhou, Yaru Chen, y Jia Gu. 2018. <span>«fastp: an ultra-fast all-in-one FASTQ preprocessor»</span>. <em>Bioinformatics</em> 34 (17): i884-90. <a href="https://doi.org/10.1093/bioinformatics/bty560">https://doi.org/10.1093/bioinformatics/bty560</a>.
</div>
<div id="ref-ewels2016" class="csl-entry" role="listitem">
Ewels, Philip, Måns Magnusson, Sverker Lundin, y Max Käller. 2016. <span>«MultiQC: summarize analysis results for multiple tools and samples in a single report»</span>. <em>Bioinformatics</em> 32 (19): 3047-48. <a href="https://doi.org/10.1093/bioinformatics/btw354">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Obtención de datos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assembly.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ensamblaje</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Ensamblaje y Anotación de Genomas Bacterianos, por <a href="https://www.linkedin.com/in/hespitianavarro/">Héctor Fabio Espitia-Navarro</a></div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://www.udenar.edu.co/">Universidad de Nariño</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://scienti.minciencias.gov.co/gruplac/jsp/visualiza/visualizagr.jsp?nro=00000000008168">Grupo de Investigación Salud Pública</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">Manual creado con <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>